<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
  <title>MongoDB Note And Pandas - Michelia</title>
  <meta name="renderer" content="webkit" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>

<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />

<meta name="theme-color" content="#f8f5ec" />
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">


<meta name="author" content="Michelia" />
  <meta name="description" content="概念 MongoDB非常强大且容易上手。 - 文档(document)是MongoDB中数据的基本单元，非常类似于关系数据库的行，但更有表现力。 - 集合(collection)可以看做是一个拥有动态模式的表。 - MongoDB的一个实例可以拥有多个相互独立的数据库，每个数据库都拥有自己的集合。
因为文档和集合是动态的，所以这两个都具有很强的表现力。 " />

  <meta name="keywords" content="Hugo, theme, even" />






<meta name="generator" content="Hugo 0.26" />


<link rel="canonical" href="http://michelia.github.io/post/data_visual/mongodb-note/" />

<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16x16.png">
<link rel="icon" href="/favicon.ico" />
<link rel="manifest" href="/manifest.json">
<link rel="mask-icon" href="/safari-pinned-tab.svg" color="#5bbad5">


<link href="/dist/even.min.css?v=2.5.0" rel="stylesheet">
<link href="/lib/fancybox/jquery.fancybox-3.1.20.min.css" rel="stylesheet">

<meta property="og:title" content="MongoDB Note And Pandas" />
<meta property="og:description" content="概念

MongoDB非常强大且容易上手。
- 文档(document)是MongoDB中数据的基本单元，非常类似于关系数据库的行，但更有表现力。
- 集合(collection)可以看做是一个拥有动态模式的表。
- MongoDB的一个实例可以拥有多个相互独立的数据库，每个数据库都拥有自己的集合。

因为文档和集合是动态的，所以这两个都具有很强的表现力。
" />
<meta property="og:type" content="article" />
<meta property="og:url" content="http://michelia.github.io/post/data_visual/mongodb-note/" />



<meta property="article:published_time" content="2015-10-23T00:00:00&#43;00:00"/>
<meta property="article:modified_time" content="2015-10-23T00:00:00&#43;00:00"/>











<meta itemprop="name" content="MongoDB Note And Pandas">
<meta itemprop="description" content="概念

MongoDB非常强大且容易上手。
- 文档(document)是MongoDB中数据的基本单元，非常类似于关系数据库的行，但更有表现力。
- 集合(collection)可以看做是一个拥有动态模式的表。
- MongoDB的一个实例可以拥有多个相互独立的数据库，每个数据库都拥有自己的集合。

因为文档和集合是动态的，所以这两个都具有很强的表现力。
">


<meta itemprop="dateModified" content="2015-10-23T00:00:00&#43;00:00" />
<meta itemprop="wordCount" content="2100">



<meta itemprop="keywords" content="database,MongoDB,pandas," />
<meta name="twitter:card" content="summary"/><meta name="twitter:title" content="MongoDB Note And Pandas"/>
<meta name="twitter:description" content="概念

MongoDB非常强大且容易上手。
- 文档(document)是MongoDB中数据的基本单元，非常类似于关系数据库的行，但更有表现力。
- 集合(collection)可以看做是一个拥有动态模式的表。
- MongoDB的一个实例可以拥有多个相互独立的数据库，每个数据库都拥有自己的集合。

因为文档和集合是动态的，所以这两个都具有很强的表现力。
"/>

<!--[if lt IE 9]>
  <script src="https://cdn.bootcss.com/html5shiv/3.7.3/html5shiv.min.js"></script>
  <script src="https://cdn.bootcss.com/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->

</head>
<body>
  <div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/" class="logo">Michelia</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>
<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    <a href="/">
        <li class="mobile-menu-item">Home</li>
      </a><a href="/post/">
        <li class="mobile-menu-item">Archives</li>
      </a><a href="/tags/">
        <li class="mobile-menu-item">Tags</li>
      </a><a href="/categories/">
        <li class="mobile-menu-item">Categories</li>
      </a>
  </ul>
</nav>
  <div class="container" id="mobile-panel">
    <header id="header" class="header">
        <div class="logo-wrapper">
  <a href="/" class="logo">Michelia</a>
</div>

<nav class="site-navbar">
  <ul id="menu" class="menu">
    <li class="menu-item">
        <a class="menu-item-link" href="/">Home</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/post/">Archives</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/tags/">Tags</a>
      </li><li class="menu-item">
        <a class="menu-item-link" href="/categories/">Categories</a>
      </li>
  </ul>
</nav>
    </header>

    <main id="main" class="main">
      <div class="content-wrapper">
        <div id="content" class="content">
          <article class="post">
    
    <header class="post-header">
      <h1 class="post-title">MongoDB Note And Pandas</h1>

      <div class="post-meta">
        <span class="post-time">
          2015-10-23
        </span>
        <div class="post-category">
            <a href="/categories/%E6%95%B0%E6%8D%AE/">数据</a>
          </div>
      </div>
    </header>

    
    
<div class="post-toc" id="post-toc">
  <h2 class="post-toc-title">文章目录</h2>
  <div class="post-toc-content">
      <nav id="TableOfContents">
<ul>
<li><a href="#概念">概念</a>
<ul>
<li><a href="#文档">文档</a></li>
<li><a href="#集合">集合</a></li>
</ul></li>
<li><a href="#客户端">客户端</a></li>
<li><a href="#查询">查询</a></li>
<li><a href="#索引">索引</a></li>
<li><a href="#管理">管理</a></li>
<li><a href="#数据操作-pandas">数据操作(pandas)</a>
<ul>
<li><a href="#下标选取数据">下标选取数据</a></li>
<li><a href="#标签选取数据">标签选取数据</a></li>
<li><a href="#位置选取数据">位置选取数据</a></li>
<li><a href="#标量取值">标量取值</a></li>
<li><a href="#逻辑array选取数据">逻辑array选取数据</a></li>
</ul></li>
<li><a href="#参考链接">参考链接</a></li>
</ul>
</nav>
  </div>
</div>

    
    <div class="post-content">
      <h1 id="概念">概念</h1>

<p>MongoDB非常强大且容易上手。
- 文档(document)是MongoDB中数据的基本单元，非常类似于关系数据库的行，但更有表现力。
- 集合(collection)可以看做是一个拥有动态模式的表。
- MongoDB的一个实例可以拥有多个相互独立的数据库，每个数据库都拥有自己的集合。</p>

<p>因为文档和集合是动态的，所以这两个都具有很强的表现力。
</p>

<h2 id="文档">文档</h2>

<p>文档是MongoDB的核心概念。文档就是一个<code>键值对</code>。python中的字典，javascript中的对象。这种键值对可简单也可很复杂。
MongoDB对<code>键</code>是字符串，有两条简单的约束：
- 键不能含有<code>\0</code>(空字符)。这个字符用于表示键的结尾。
- <code>.</code>和<code>$</code>具有特殊意义，通常这两个是保留字符，所以建议不要用在<code>键</code>中。</p>

<h2 id="集合">集合</h2>

<p>集合就是一组文档。如果将MongoDB中的一个文档比喻为关系数据库中的一行，那个一个集合就相当于一张表。
MongoDB中的集合是可以动态构建的。即在插入数据时，如果没有某个集合，则自动创建。</p>

<h1 id="客户端">客户端</h1>

<p>日常分析数据时，需要便捷的客户端，这里强烈推荐<a href="http://www.robomongo.org/">Robomongo</a>，真的是超级方便啊。</p>

<h1 id="查询">查询</h1>

<p>先查看这里<a href="http://docs.mongoing.com/manual/reference/sql-comparison.html#select">http://docs.mongoing.com/manual/reference/sql-comparison.html#select</a>，以后再总结。
排除不包含<code>status</code>键的<code>document</code>： <code>db.collection.find({'status': {$ne: null}})</code>。</p>

<h1 id="索引">索引</h1>

<p>数据量大的时候，可以建立索引以便加快查询的速度。
查看索引 db.collection.getIndexes()
db.collection.ensureIndex({status:1 }) <code>1</code>代表索引的方向，为正向。</p>

<h1 id="管理">管理</h1>

<p>参考
&gt; <a href="http://blog.51yip.com/nosql/1573.html">mongodb 备份 还原 导出 导入</a></p>

<blockquote>
<p><a href="http://blog.51yip.com/nosql/1575.html">mongodb 用户 权限 设置 详解</a></p>
</blockquote>

<h1 id="数据操作-pandas">数据操作(pandas)</h1>

<p>把mongo和python连接起来就是分析数据的利器了，而这个工具就是<strong>pandas</strong>。
首先要把需要分析数据导入到pandas中参考<a href="http://stackoverflow.com/questions/16249736/how-to-import-data-from-mongodb-to-pandas/">How to import data from mongodb to pandas?</a>。
那么<strong>pandas</strong>中最重要的就是DataFrame了，一般简写为<code>df</code>。
接下来最重要的就是操作<code>df</code>，首先是要取数据，开始常用的是按位置取值<code>iloc</code></p>

<p><code>取值</code>是pandas的强悍功能。</p>

<table>
<thead>
<tr>
<th align="left">操作符</th>
<th align="left">含义</th>
</tr>
</thead>

<tbody>
<tr>
<td align="left">obj.ix[:, val]</br>obj.loc[:val]</br>obj.iloc[:val]</br>obj.icol(val)</td>
<td align="left">obj[val]   从Series选择单个值/多个值可以切片，可以是单个值</br>从DataFrame选择单一列/多列</br>obj[val] val是 字符的列标签</br>&emsp;</td>
</tr>

<tr>
<td align="left">obj[布尔数据]</td>
<td align="left">Series: 过滤 值</br>DataFrame: 过滤行</td>
</tr>

<tr>
<td align="left">obj[col]</br>obj[[col1, col2]]</td>
<td align="left">选择列</br>选择多列</td>
</tr>

<tr>
<td align="left">obj[1:3] </br><code>obj['b':'d']</code></td>
<td align="left">Series: 切片</br>DataFrame: 行切片(取1-3行，0坐标)</td>
</tr>

<tr>
<td align="left">obj.ix[val]</br>obj.loc[val]</br>obj.iloc[val]</br>obj.irow(val)</td>
<td align="left">从DataFrame的行集选择单行/多行</td>
</tr>

<tr>
<td align="left">obj.ix[val1, val2]</td>
<td align="left">选择DataFrame行和列</td>
</tr>

<tr>
<td align="left">obj.loc[]</td>
<td align="left">df.loc[row_indexer,column_indexer] str标签</td>
</tr>

<tr>
<td align="left">obj.iloc[]</td>
<td align="left">df.loc[row_int,column_int] int标签</td>
</tr>
</tbody>
</table>

<p></br></p>

<h2 id="下标选取数据">下标选取数据</h2>

<pre><code>df['one']
df.one
</code></pre>

<p>以上两个语句是等效的，都是返回df名称为one列的数据，返回的为一个Series。</p>

<pre><code>df[0:3]
</code></pre>

<p>另外<del><code>df[0]</code></del>已经不支持，不要使用，请使用<code>df.iloc[0]</code>。
下标索引选取的是DataFrame的记录(行)，与List相同DataFrame的下标也是从0开始，区间索引的话，为一个左闭右开的区间，即<code>[0：3]</code>选取的为1-3三条记录。
与此等价，还可以用起始的索引名称和结束索引名称选取数据：</p>

<pre><code>df['a':'b']
</code></pre>

<p>有一点需要注意的是使用起始索引名称和结束索引名称时，也会<strong>包含结束索引的数据</strong>。以上两种方式返回的都是DataFrame。</p>

<h2 id="标签选取数据">标签选取数据</h2>

<pre><code class="language-python">df.loc[行标签,列标签]
df.loc['a':'b']     #选取ab两行数据
df.loc[:,'one']     #选取one列的数据
</code></pre>

<p>df.loc的第一个参数是行标签，第二个参数为列标签（可选参数，默认为所有列标签），两个参数既可以是列表也可以是单个字符，如果两个参数都为列表则返回的是DataFrame，否则，则为Series。</p>

<h2 id="位置选取数据">位置选取数据</h2>

<pre><code class="language-python">df.iloc[行位置,列位置]
df.iloc[1,1]         #选取第二行，第二列的值，返回的为单个值
df.iloc[0,2],:]      #选取第一行及第三行的数据
df.iloc[0:2,:]       #选取第一行到第三行（不包含）的数据
df.iloc[:,1]         #选取所有记录的第一列的值，返回的为一个Series
df.iloc[1,:]         #选取第一行数据，返回的为一个Series
df.iloc[-1,:]        #选取最后一行数据，返回的为一个Series， 支持 -1
</code></pre>

<p>PS：loc为location的缩写，iloc则为integer &amp; location的缩写</p>

<p>更广义的切片方式是使用.ix，它自动根据你给到的索引类型判断是使用位置还是标签进行切片</p>

<pre><code>df.ix[1,1]
df.ix['a':'b']
</code></pre>

<h2 id="标量取值">标量取值</h2>

<pre><code>df.at['a', 'one']
df.iat[0, 2]
</code></pre>

<p><code>.at</code>和<code>.iat</code>只能取标量，即只能取单个值
这与<code>.loc</code> 和  <code>.iloc</code>不同，<code>.loc</code> 和  <code>.iloc</code>能使用<code>x:y</code>取一个范围，也能取标量。
那为什么要有<code>.at</code>和<code>.iat</code>，因为取单个值的时候，<code>.at</code>和<code>.iat</code>的速度是很快的。</p>

<h2 id="逻辑array选取数据">逻辑array选取数据</h2>

<pre><code class="language-python">df[逻辑条件]
df[df.one &gt;= 2]                     #单个逻辑条件
df[(df.one &gt;=1 ) &amp; (df.one &lt; 3) ]   #多个逻辑条件组合
df[(df.username == '') &amp; map(lambda x: x['user_id']=='', df.context)]
或
c = [True, False, True]
df[c]
df.iloc[:, c]
df.loc[:, c]
df.loc[c, :]
</code></pre>

<p>说明：
&gt; <code>|</code> 代表 <code>or</code>, <code>&amp;</code> 代表 <code>and</code>, and <code>~</code> 代表 <code>not</code>
&gt; 这种方式获得的数据切片都是DataFrame。
&gt; pandas中的<strong>Boolean indexing</strong>必须是包含<code>True</code>或<code>Fasle</code>的<code>list</code>。包含<code>0</code>或<code>1</code>得不到想要的值，不能是<code>迭代器</code>，必须是<code>list</code>。
&gt; 下标bool取值只能过滤记录(行)，所以既要过滤行又要过滤列，直接使用<code>标签或位置bool取值</code>
&gt; iloc、loc等等也都可以使用<strong>Boolean indexing</strong>，如<code>c = [True, Fasle]; df.iloc[:, c]</code>。</p>

<h1 id="参考链接">参考链接</h1>

<ul>
<li><a href="http://docs.mongoing.com/manual-zh/">MongoDB 2.6 中文文档</a></li>
<li><a href="https://docs.mongodb.org/manual/">MongoDB　Manual</a></li>
<li><a href="https://docs.mongodb.org/getting-started/python/">Getting Started with MongoDB (Python Edition)</a></li>
<li><a href="http://pandas.pydata.org/pandas-docs/stable/">Pandas Documentation</a></li>
<li><a href="http://cloga.info/python/%E6%95%B0%E6%8D%AE%E7%A7%91%E5%AD%A6/2013/09/17/pandas_intro/">Python中的结构化数据分析利器-Pandas简介</a></li>
<li><a href="http://blog.51yip.com/nosql/1573.html">mongodb 备份 还原 导出 导入</a></li>
<li><a href="http://blog.51yip.com/nosql/1575.html">mongodb 用户 权限 设置 详解</a></li>
</ul>
    </div>

    
    

    
    

    <footer class="post-footer">
      <div class="post-tags">
          
          <a href="/tags/database/">database</a>
          
          <a href="/tags/mongodb/">MongoDB</a>
          
          <a href="/tags/pandas/">pandas</a>
          
        </div>

      
      <nav class="post-nav">
        
          <a class="prev" href="/post/%E4%BD%BF%E7%94%A8hugo%E6%90%AD%E5%BB%BA%E7%8B%AC%E7%AB%8B%E5%8D%9A%E5%AE%A2/">
            <i class="iconfont icon-left"></i>
            <span class="prev-text nav-default">使用Hugo搭建独立博客</span>
            <span class="prev-text nav-mobile">上一篇</span>
          </a>
        
          <a class="next" href="/post/data_visual/echarts-note/">
            <span class="next-text nav-default">echarts note</span>
            <span class="prev-text nav-mobile">下一篇</span>
            <i class="iconfont icon-right"></i>
          </a>
      </nav>
    </footer>
  </article>
        </div>
        
  

  
      </div>  
    </main>

    <footer id="footer" class="footer">
      <div class="social-links">
        <a href="https://github.com/michelia" class="iconfont icon-github" title="github"></a>
  <a href="http://michelia.github.io/index.xml" type="application/rss+xml" class="iconfont icon-rss" title="rss"></a>
</div>

<div class="copyright">
  <span class="power-by">
    由 <a class="hexo-link" href="https://gohugo.io">Hugo</a> 强力驱动
  </span>
  <span class="division">|</span>
  <span class="theme-info">
    主题 - 
    <a class="theme-link" href="https://github.com/olOwOlo/hugo-theme-even">Even</a>
  </span>

  <span class="copyright-year">
    &copy; 
    
      2014 - 
    2017
    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">Michelia</span>
  </span>
</div>
    </footer>

    <div class="back-to-top" id="back-to-top">
      <i class="iconfont icon-up"></i>
    </div>
  </div>
  
<script src="/lib/highlight/highlight.pack.js"></script>
<script type="text/javascript" src="/lib/jquery/jquery-3.2.1.min.js"></script>
  <script type="text/javascript" src="/lib/slideout/slideout-1.0.1.min.js"></script>
  <script type="text/javascript" src="/lib/fancybox/jquery.fancybox-3.1.20.min.js"></script>
<script type="text/javascript" src="/dist/even.min.js?v=2.5.0"></script>

<script async src='https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-MML-AM_CHTML'></script>




</body>
</html>
